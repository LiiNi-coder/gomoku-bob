# 오목

렌주, Swap2, Pro 규칙의 합성 및 간략화본

## 좌표계

![https://i.namu.wiki/i/ZEELt-htub_gKdX0GuMyVLAFptvFck78oELdKbU5vsx-S8YbujhcHZV4-cII1B6kIAxxttccJtGIKqHfaoNWSiqG1Wwp5Qd7KFJoftIEWR2KbUgB-rIWWMOU9Sok8yFaWO96K2wOPDPIqJ9S2J7eaA.webp]()

기본적으로 위의 좌표계(15*15)를 사용하되,
0-base의 수를 이용하기로 하자.
따라서, $P = \{ (x, y) | 0 \ge x,y \ge 14 \}$로 이루어진 좌표계를 사용한다.

## 규칙

기본적으로 렌주와 swap2, pro룰을 섞어 쉽게 만들었다.

용어:

- 착수: 돌을 둠
- {어떤 돌 A를 기준으로} {자신의 칸을 포함하여 6칸 내에} {어떤 방향에 나열된 같은 색상의 돌의 최대 개수}를 A의 위상이라고 하자 (단, 해당 방향에 다른 색의 돌이 착수되어있다면, 그 이상 셈하지 않기로 하자)
    - 어떤 돌을 착수함으로써 위상이 3인 형태가 2개 이상 발생하는 경우 3-3이라고 부르자.
    - 어떤 돌을 착수함으로써 위상이 4인 형태가 2개 이상 발생하는 경우 4-4라고 부르자.
    - 어떤 돌을 착수함으로써 위상이 6이상인 형태가 발생하는 경우 장목이라고 부르자

기본:

- 선수를 흑이라고 하자.
- 3-3은 백만 허용된다고 하자.
- 4-4는 백만 허용된다고 하자.
- 장목은 백만 허용된다고 하자.

(4-3 혹은 3-4는 허용됨에 유의하라)

오프닝:

- 첫 수는 천원에 두어진다.
- 대국자 A는 두 수를 둔다.
- 대국자 B는 두 수를 두고 대국자 A에게 흑백 선택권을 넘긴다.

시간초과:

- 서버가 

## 프로토콜

- U1 : uint8_t

### 로비

1. 대국자는 서버에 0(U1)을 전송한다.
2. 서버는 대국자에게 고유 id (U1)를 전송한다.
3. 서버는 대국자에게 struct users를 전송한다.

- 대국자는 서버에 1(U1)과 상대 대국자 id (U1)를 전송한다.
    1. 없는 대국자(혹은 응답이 없다면) (혹은 요청자 자신이라면)라면 서버는 255를 전송하고 3으로 돌아간다.
    2. 아니라면 오프닝으로 이동한다.
- 또는: 서버는 대국자에게 3(U1)을 전송한다.
    1. 오프닝으로 이동한다

### 오프닝

1. 대국자는 서버가 3(U1)을 전송할 때까지 대기한다
    - 서버는 전송한 즉시 전체 판의 상태를 struct log에 맞추어 전송한다.

2. 대국자는 처음 둘 수(백)을 서버에 struct execute에 맞추어 송신한다.
    - 둘 수 없는 수라면 서버는 255(U1)을 전송한다. 2로 돌아간다.
    - timeout에서 서버는 254(U1)를 전송한다. 경기는 대국자의 패배가 된다. 종료로 이동한다.
3. 대국자는 둘째 둘 수(흑)을 서버에 struct execute에 맞추어 송신한다.
    - 둘 수 없는 수라면 서버는 255(U1)을 전송한다. 3으로 돌아간다.
    - timeout에서 서버는 254(U1)를 전송한다. 경기는 대국자의 패배가 된다. 종료로 이동한다.

4. 대국자는 서버가 3(U1)또는 4(U1)을 전송할 때까지 대기한다
    - 서버가 4를 전송하였을 때, 대국자는 1(흑, U1)혹은 2(백, U1)을 전송하여야 한다. 이때, 대국자의 색상은 요청대로 변경된다.
    - timeout에서 서버는 254(U1)를 전송한다. 경기는 대국자의 패배가 된다.
5. 서버는 대국자에게 1(U1)또는 0(U1)을 전송한다.
    - 1: 흑 (후)
    - 0: 백 (선)

### 일반

1. 대국자는 서버가 3(U1)또는 4(U1), 5(U1)을 전송할 때까지 대기한다.
    - 3의 경우 2로 이동한다.
    - 4의 경우 대국자의 승리다. 종료로 이동한다.
    - 5의 경우 대국자의 패배다. 종료로 이동한다.

2. 서버는 대국자에게 판의 변경사항을 struct log에 맞추어 전송한다.

3. 대국자는 둘 수를 서버에 struct execute에 맞추어 송신한다.
    - 둘 수 없는 수라면 서버는 255(U1)을 전송한다. c로 돌아간다.
    - timeout에서 서버는 254(U1)를 전송한다. 경기는 대국자의 패배가 된다. 종료로 이동한다.

### 종료

1. 서버는 대국자에게 판의 변경사항을 struct log에 맞추어 전송한다.
2. 세션은 파기된다.
3. 로비로 돌아간다.

## 구조체

### struct users

```
+------------+-------------------
| Count (U1) | User ID (U1) ... 
+------------+-------------------
```

### struct execute

```
+----------+----------+
| x (4bit) | y (4bit) |
+----------+----------+
```

### struct log

```
+------------+---------------------
| Count (U1) | struct execute ...
+------------+---------------------
```
